<h1>Feature: Step definition could use pytest fixtures as step parameters</h1>
<p>Test setup is implemented within the Given section. Even though these steps
are executed imperatively to apply possible side-effects, pytest-bdd-ng is trying
to benefit of the PyTest fixtures which is based on the dependency injection
and makes the setup more declarative style.</p>
<p>In pytest-bdd-ng you just declare an argument of the step function that it depends on
and the PyTest will make sure to provide it.</p>
<h2>Scenario:</h2>
<ul>
<li>
<p>Given File &quot;conftest.py&quot; with content:</p>
<pre><code class="language-python">from pytest import fixture
from pytest_bdd import given, when, then

@fixture
def pocket():
  yield [{&quot;cherry&quot;: &quot;delicious&quot;}]

@given(&quot;I have an old pickle&quot;, param_defaults={&quot;age&quot;: &quot;old&quot;}, target_fixture='pickle_age', params_fixtures_mapping=False)
def i_have_cucumber(pocket):
    pocket.append({&quot;age&quot;: &quot;old&quot;, &quot;cucumber&quot;: &quot;pickle&quot;})

@when(&quot;I check pocket I found cucumber there&quot;)
def i_check_pocket_for_cucumber(pocket):
  assert any(filter(lambda item: &quot;cucumber&quot; in item.keys(), pocket))

@then(&quot;I lost everything&quot;)
def i_check_pocket_for_cucumber(pocket):
  while pocket:
    pocket.pop()
</code></pre>
</li>
<li>
<p>Given File &quot;Cucumber.feature&quot; with content:</p>
<pre><code class="language-gherkin">Feature:
  Scenario:
    Given I have an old pickle
    When I check pocket I found cucumber there
    Then I lost everything
</code></pre>
</li>
<li>
<p>Given File &quot;test_freshness.py&quot; with content:</p>
<pre><code class="language-python">from pytest_bdd import scenario

@scenario(&quot;Cucumber.feature&quot;)
def test_passing_feature(pocket):
  assert not pocket
</code></pre>
</li>
<li>
<p>When run pytest</p>
<table>
<thead>
<tr>
<th>cli_args</th>
<th>--disable-feature-autoload</th>
</tr>
</thead>
</table>
</li>
<li>
<p>Then pytest outcome must contain tests with statuses:</p>
<table>
<thead>
<tr>
<th>passed</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
</tr>
</tbody>
</table>
</li>
</ul>
